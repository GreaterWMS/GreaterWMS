(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[51],{"3ac0":function(e,t,o){"use strict";var a=o("a49c"),i=o.n(a);t["default"]=i.a},"92ae":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("q-input",{staticStyle:{display:"none"},model:{value:e.scaneddata.request_time,callback:function(t){e.$set(e.scaneddata,"request_time",t)},expression:"scaneddata.request_time"}}),t("q-card",{directives:[{name:"show",rawName:"v-show",value:!e.fab,expression:"!fab"}],style:{width:e.width,height:e.height},attrs:{flat:""}},[t("q-card-section",[t("q-bar",{staticClass:"bg-white q-mb-sm shadow-1"},[t("div",{staticStyle:{"font-size":"12px",width:"100%"}},[e._v("From "+e._s(e.$t("warehouse.view_binset.bin_name"))+": "+e._s(e.frombin))])]),t("q-bar",{staticClass:"bg-white shadow-1"},[t("div",{staticStyle:{"font-size":"12px",width:"100%"}},[e._v("To "+e._s(e.$t("warehouse.view_binset.bin_name"))+": "+e._s(e.tobin))])])],1),t("q-scroll-area",{style:{height:e.scroll_height,width:e.width},attrs:{"thumb-style":e.thumbStyle,"bar-style":e.barStyle}},[t("q-markup-table",[t("thead",[t("tr",[t("th",{staticClass:"text-center"},[e._v(e._s(e.goods_code_label))]),t("th",{staticClass:"text-center"},[e._v(e._s(e.goods_qty_label))]),t("th",{staticClass:"text-center"},[e._v(e._s(e.move_qty_label))])])]),t("tbody",[e._l(e.table_list,(function(o,a){return t("tr",{key:a},[t("td",{class:{"scan-background text-center":o.t_code===e.t_code,"text-center":o.t_code!==e.t_code}},[e._v(e._s(o.goods_code))]),t("td",{class:{"scan-background text-center":o.t_code===e.t_code,"text-center":o.t_code!==e.t_code}},[e._v(e._s(o.goods_qty))]),t("td",{staticClass:"text-center"},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:o.move_qty,expression:"item.move_qty",modifiers:{number:!0}}],attrs:{type:"number",label:e.move_qty_label},domProps:{value:o.move_qty},on:{input:[function(t){t.target.composing||e.$set(o,"move_qty",e._n(t.target.value))},function(t){return e.inputMoveData(o)}],blur:function(t){return e.$forceUpdate()}}})])])}))],2)])],1)],1)],1)},i=[],s=(o("caad"),o("3004")),n=o("18d6"),c=o("09f9"),d={name:"Page_movetobin",data(){return{openid:"",login_name:"",authin:"0",pathname:"movetobin/",width:"",height:"",scroll_height:"",table_list:[],goods_code_label:this.$t("stock.view_stocklist.goods_code"),goods_qty_label:this.$t("stock.view_stocklist.onhand_stock"),move_qty_label:"Move Qty",thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"#E0E0E0",width:"5px",opacity:.75},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"#EEEEEE",width:"9px",opacity:.2},bar_scanned:"",frombin:"",tobin:"",moved:!1,t_code:"",movecheck:[],movedata:[]}},methods:{getGoodsList(e){var t=this;Object(s["e"])("goods/?goods_code="+e,{}).then((e=>{if(0===e.results.length)navigator.vibrate(100),t.$q.notify({message:"No Goods Data",position:"top",icon:"close",color:"negative"});else if(1===e.results.length)if(t.movecheck=[],t.table_list.filter((o=>{o.bin_name.includes(t.bin_scan)&&o.goods_code.includes(e.results[0].goods_code)&&t.movecheck.push(o)})),t.movecheck.length>0){var o=0,a=!1;t.movecheck.forEach((e=>{e.move_qty!==e.goods_qty-e.pick_qty-e.picked_qty||a?e.move_qty<e.goods_qty-e.pick_qty-e.picked_qty&&!a&&t.table_list.filter((o=>{if(o.t_code.includes(e.t_code)){a=!0,t.t_code=o.t_code,o.move_qty+=1;var i={},s=!1;i={bin_name:t.frombin,move_to_bin:t.tobin,goods_code:o.goods_code,move_qty:o.move_qty,t_code:o.t_code},0===t.movedata.length?(s=!0,t.movedata.push(i)):t.movedata.filter((t=>{t.t_code.includes(e.t_code)&&(s=!0,t.move_qty+=1)})),s||t.movedata.push(i)}})):o+=1})),o===t.movecheck.length&&(navigator.vibrate(100),t.$q.notify({message:"Move More Qty",position:"top",icon:"close",color:"negative"})),t.movecheck=[]}else navigator.vibrate(100),t.$q.notify({message:"No Goods Data",position:"top",icon:"close",color:"negative"});else navigator.vibrate(100),t.$q.notify({message:"Repeating Data",position:"top",icon:"close",color:"negative"})})).catch((e=>{navigator.vibrate(100),t.$q.notify({message:e.detail,position:"top",icon:"close",color:"negative"})}))},getFromBinList(e){var t=this;Object(s["e"])("stock/bin/?bin_name="+e,{}).then((e=>{0===e.results.length?(navigator.vibrate(100),t.$q.notify({message:"No Bin Data",position:"top",icon:"close",color:"negative"})):(t.table_list=[],e.results.forEach((e=>{e.move_qty=0,t.table_list.push(e)})),t.frombin=t.scaneddata.code,t.moved=!0)})).catch((e=>{navigator.vibrate(100),t.$q.notify({message:e.detail,position:"top",icon:"close",color:"negative"})}))},getToBinList(e){var t=this;Object(s["e"])("binset/?bin_name="+e,{}).then((e=>{0===e.results.length?(navigator.vibrate(100),t.$q.notify({message:"No Bin Data",position:"top",icon:"close",color:"negative"})):1===e.results.length?(t.tobin=t.scaneddata.code,t.movedata.forEach((e=>{e.move_to_bin=t.tobin})),t.moved=!1,t.moveSubmit()):(navigator.vibrate(100),t.$q.notify({message:"Repeating Data",position:"top",icon:"close",color:"negative"}))})).catch((e=>{navigator.vibrate(100),t.$q.notify({message:e.detail,position:"top",icon:"close",color:"negative"})}))},inputMoveData(e){var t=this;0===t.movedata.length?t.movedata.push(e):t.movedata.forEach(((o,a)=>{e.t_code===o.t_code?e.move_qty>o.move_qty&&(t.movedata.splice(a,1),t.movedata.push(e)):t.movedata.push(e)}))},moveSubmit(){var e=this;e.movedata.forEach((t=>{t.bin_name=e.frombin,t.move_to_bin=e.tobin})),Object(s["i"])("stock/bin/",e.movedata).then((t=>{e.$q.notify({message:"Success Move To Bin"+e.tobin,position:"top",icon:"check",color:"green"}),e.movecheck=!1,e.table_list=[],e.frombin="",e.tobin=""})).catch((t=>{e.$q.notify({message:t.detail,icon:"close",color:"negative"})}))}},computed:{fab:{get(){return this.$store.state.fabchange.fab}},scaneddata:{get(){return this.$store.state.scanedsolve.scaneddata}}},created(){var e=this;n["a"].has("openid")?e.openid=n["a"].getItem("openid"):(e.openid="",n["a"].set("openid","")),n["a"].has("login_name")?e.login_name=n["a"].getItem("login_name"):(e.login_name="",n["a"].set("login_name","")),n["a"].has("auth")?e.authin="1":e.authin="0"},mounted(){var e=this;e.width=1*c["a"].width+"px",e.height=c["a"].height-50+"px",e.scroll_height=c["a"].height-200+"px"},updated(){var e=this;""!==e.scaneddata&&e.bar_scanned!==e.scaneddata.request_time&&("BINSET"===e.scaneddata.mode?e.moved?(e.bar_scanned=e.scaneddata.request_time,e.bin_scan=e.scaneddata.code,e.getToBinList(e.scaneddata.code)):(e.bar_scanned=e.scaneddata.request_time,e.bin_scan=e.scaneddata.code,e.getFromBinList(e.scaneddata.code)):"GOODS"===e.scaneddata.mode?""!==e.bin_scan?(e.bar_scanned=e.scaneddata.request_time,e.getGoodsList(e.scaneddata.code)):e.$q.notify({message:"No Bin Query Data",position:"top",icon:"close",color:"negative"}):e.$q.notify({message:"No Query Data",position:"top",icon:"close",color:"negative"}))},beforeDestroy(){}},r=d,l=o("42e1"),_=o("3ac0"),m=o("27f9"),v=o("f09f"),h=o("a370"),b=o("d847"),g=o("4983"),u=o("2bb1"),p=o("eebe"),f=o.n(p),y=Object(l["a"])(r,a,i,!1,null,null,null);"function"===typeof _["default"]&&Object(_["default"])(y);t["default"]=y.exports;f()(y,"components",{QInput:m["a"],QCard:v["a"],QCardSection:h["a"],QBar:b["a"],QScrollArea:g["a"],QMarkupTable:u["a"]})},a49c:function(e,t){}}]);