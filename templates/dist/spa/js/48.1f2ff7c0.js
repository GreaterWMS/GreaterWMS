(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[48],{"540e":function(e,t,a){"use strict";var n=a("877c"),o=a.n(n);t["default"]=o.a},"877c":function(e,t){},"8c09":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[t("q-input",{staticStyle:{display:"none"},model:{value:e.scaneddata.request_time,callback:function(t){e.$set(e.scaneddata,"request_time",t)},expression:"scaneddata.request_time"}}),t("q-card",{directives:[{name:"show",rawName:"v-show",value:!e.fab,expression:"!fab"}],style:{width:e.width,height:e.height}},[t("q-card-section",[t("q-btn-group",{attrs:{push:""}},[t("q-btn",{attrs:{color:"purple",label:e.$t("stock.view_stocklist.cyclecountresult")},on:{click:function(t){return e.ConfirmCount()}}})],1)],1),t("q-scroll-area",{style:{height:e.scroll_height,width:e.width},attrs:{"thumb-style":e.thumbStyle,"bar-style":e.barStyle}},[t("q-markup-table",[t("thead",[t("tr",[t("th",{staticClass:"text-center"},[e._v(e._s(e.bin_name_label))]),t("th",{staticClass:"text-center"},[e._v(e._s(e.goods_code_label))]),t("th",{staticClass:"text-center"},[e._v(e._s(e.physical_label))]),t("th",{staticClass:"text-center"},[e._v(e._s(e.action_label))])])]),t("tbody",[e._l(e.table_list,(function(a,n){return t("tr",{key:n},[t("td",{class:{"scan-background text-center":a.bin_name===e.bin_scan,"text-center":a.bin_name!==e.bin_scan}},[e._v(e._s(a.bin_name))]),t("td",{class:{"scan-background text-center":a.bin_name===e.bin_scan&&a.goods_code===e.goods_scan,"text-center":a.bin_name!==e.bin_scan&&a.goods_code!==e.goods_scan}},[e._v(e._s(a.goods_code))]),t("td",{class:{"scan-background text-center":a.bin_name===e.bin_scan&&a.goods_code===e.goods_scan,"text-center":a.bin_name!==e.bin_scan&&a.goods_code!==e.goods_scan}},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.physical_inventory,expression:"item.physical_inventory",modifiers:{number:!0}}],attrs:{type:"number",label:e.physical_label},domProps:{value:a.physical_inventory},on:{input:function(t){t.target.composing||e.$set(a,"physical_inventory",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),t("td",{staticClass:"text-center"},[t("q-btn",{staticStyle:{width:"50px"},attrs:{round:"",flat:"",push:"",color:"purple",icon:"repeat"},on:{click:function(t){return e.repeatCount(n)}}})],1)])}))],2)])],1),t("q-separator",{attrs:{dark:""}})],1)],1)},o=[],s=(a("caad"),a("3004")),i=a("18d6"),c=a("09f9"),r={name:"Page_cyclecount",data(){return{openid:"",login_name:"",authin:"0",pathname:"cyclecount/",width:"",height:"",scroll_height:"",table_list:[],bin_name_label:this.$t("warehouse.view_binset.bin_name"),goods_code_label:this.$t("stock.view_stocklist.goods_code"),physical_label:this.$t("stock.view_stocklist.physical_inventory"),action_label:this.$t("action"),thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"#E0E0E0",width:"5px",opacity:.75},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"#EEEEEE",width:"9px",opacity:.2},bar_scanned:"",bin_scan:"",goods_scan:""}},methods:{getList(){var e=this;Object(s["e"])(e.pathname,{}).then((t=>{e.table_list=t})).catch((t=>{e.$q.notify({message:t.detail,icon:"close",color:"negative"})}))},getGoodsList(e){var t=this;Object(s["e"])("goods/?goods_code="+e,{}).then((e=>{0===e.results.length?(navigator.vibrate(100),t.$q.notify({message:"No Goods Data",position:"top",icon:"close",color:"negative"})):1===e.results.length?t.table_list.filter((a=>{if(a.bin_name.includes(t.bin_scan)&&a.goods_code.includes(e.results[0].goods_code))return t.goods_scan=e.results[0].goods_code,a.physical_inventory+=1,a.difference=a.physical_inventory-a.goods_qty,!1})):(navigator.vibrate(100),t.$q.notify({message:"Repeating Data",position:"top",icon:"close",color:"negative"}))})).catch((e=>{navigator.vibrate(100),t.$q.notify({message:e.detail,position:"top",icon:"close",color:"negative"})}))},getBinList(e){var t=this;Object(s["e"])("binset/?bin_name="+e,{}).then((e=>{0===e.results.length?(navigator.vibrate(100),t.$q.notify({message:"No Bin Data",position:"top",icon:"close",color:"negative"})):1===e.results.length?t.bin_scan=e.results[0].bin_name:(navigator.vibrate(100),t.$q.notify({message:"Repeating Data",position:"top",icon:"close",color:"negative"}))})).catch((e=>{navigator.vibrate(100),t.$q.notify({message:e.detail,position:"top",icon:"close",color:"negative"})}))},repeatCount(e){var t=this;t.goods_scan="",t.table_list[e].physical_inventory=0},ConfirmCount(){var e=this;Object(s["i"])(e.pathname,e.table_list).then((t=>{e.reFresh(),e.$q.notify({message:"Success Confirm Cycle Count",position:"top",icon:"check",color:"green"})})).catch((t=>{e.$q.notify({message:t.detail,position:"top",icon:"close",color:"negative"})}))},reFresh(){var e=this;e.table_list=[],e.barscan="",e.bin_scan="",e.goods_scan="",e.getList()}},computed:{fab:{get(){return this.$store.state.fabchange.fab}},scaneddata:{get(){return this.$store.state.scanedsolve.scaneddata}}},created(){var e=this;i["a"].has("openid")?e.openid=i["a"].getItem("openid"):(e.openid="",i["a"].set("openid","")),i["a"].has("login_name")?e.login_name=i["a"].getItem("login_name"):(e.login_name="",i["a"].set("login_name","")),i["a"].has("auth")?(e.authin="1",e.getList()):e.authin="0"},mounted(){var e=this;e.width=1*c["a"].width+"px",e.height=c["a"].height-50+"px",e.scroll_height=c["a"].height-175+"px"},updated(){var e=this;""!==e.scaneddata&&e.bar_scanned!==e.scaneddata.request_time&&("BINSET"===e.scaneddata.mode?(e.bar_scanned=e.scaneddata.request_time,e.getBinList(e.scaneddata.code)):"GOODS"===e.scaneddata.mode?""!==e.bin_scan?(e.bar_scanned=e.scaneddata.request_time,e.getGoodsList(e.scaneddata.code)):e.$q.notify({message:"No Bin Query Data",position:"top",icon:"close",color:"negative"}):e.$q.notify({message:"No Query Data",position:"top",icon:"close",color:"negative"}))},beforeDestroy(){},destroyed(){}},l=r,d=a("42e1"),_=a("540e"),h=a("27f9"),b=a("f09f"),u=a("a370"),g=a("e7a9"),p=a("9c40"),m=a("4983"),v=a("2bb1"),y=a("eb85"),f=a("eebe"),q=a.n(f),w=Object(d["a"])(l,n,o,!1,null,null,null);"function"===typeof _["default"]&&Object(_["default"])(w);t["default"]=w.exports;q()(w,"components",{QInput:h["a"],QCard:b["a"],QCardSection:u["a"],QBtnGroup:g["a"],QBtn:p["a"],QScrollArea:m["a"],QMarkupTable:v["a"],QSeparator:y["a"]})}}]);